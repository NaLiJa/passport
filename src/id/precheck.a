;-------------------------------
; PreCheckT00
;
; Before we trace through the drive firmware (which --
; at least on some machines -- will loop forever looking
; for each sector), we do a pre-check to ensure that all
; the sectors we're about to trace are actually readable.
;
; Before calling this function, you need to set all 16
; bytes of the precheck_sectors array to a positive
; number (check that sector) or a negative number (don't
; check that sector). The array is ordered by logical
; sectors, regardless of the type of disk.
;
; If all required sectors are readable by Passport's own
; sector read routine, this exits gracefully with all
; flags and registered clobbered.
;
; If any required sector fails to read, this exits via
; FatalError, which does not return.
;-------------------------------
PreCheckT00
         lda   #$00
         sta   gTrack
         ldy   #$00
@precheck_loop
         lda   precheck_sectors,y
         bmi   +
         sta   gSector
         jsr   IgnoreAddressChecksum
         tya
         pha
         jsr   ReadSector
         pla
         tay
         bcc   +
         jmp   FatalError
+
         iny
         cpy   #$10
         bne   @precheck_loop
         rts
