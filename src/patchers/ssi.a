;-------------------------------
; #SSI protections
; weak bit, magic values
;
; module by qkumba
;-------------------------------
!zone {
         bit   gMode      ; nothing to do here in verify-only mode
         bpl   .exit
         ldy   gIsRDOS13
         bne   .exit

         ldy   #$0F
         jsr   SearchTrack
         !byte WILDCARD,$00; xxx $00 (sometimes DEC, sometimes CMP)
         !byte $F0,$17    ; BEQ *+$19
         !byte $20,$65,$BC; JSR $BC65
         !byte $B0,$F7    ; BCS *-7
         !byte $C1,$00    ; CMP ($00,X)
         !byte $C1,$00    ; CMP ($00,X)
         !byte $EA        ; NOP
         !byte $EA        ; NOP
         bcs   +

         sta   gDisplayBytes
         pha
         lda   #s_ssi
         jsr   PrintByID
         pla
         ldy   #$01
         jsr   modify
         !byte $A9        ; LDA #$..
         bvc   .exit

+
         ldy   #$0E
         jsr   SearchTrack
         !byte $CE,$07,$02; DEC $0207
         !byte $EF,$07,$02; ??? $0207
         !byte $A0,$27    ; LDY #$27
         !byte $D0,$02    ; BNE *+4
         !byte $00        ; BRK
         !byte $6C,$B9,$00; JMP ($00B9)
         bcs   .exit
         ldy   #1
         jsr   modify
         !byte $60        ; RTS

.exit
}
